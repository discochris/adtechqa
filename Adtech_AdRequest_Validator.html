<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AdTech - AdRequest URL Validator</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <h2 class="title">AdTech - AdRequest URL Validator</h2>
      <h4 id="error" class="text-danger text-center"></h4>

      <div class="row g-3">
        <div class="col-md-4">
          <label for="Country" class="form-label">Country</label>
          <select id="Country" class="form-select">
            <option value="AUS">AUS</option>
            <!-- <option value="USA">USA</option>
            <option value="UK">UK</option>
            <option value="SE">SE</option> -->
          </select>
        </div>
        <div class="col-md-4">
          <label for="device" class="form-label">Device</label>
          <select id="device" class="form-select">
            <option value="chrome">Chrome</option>
            <option value="safari">Safari</option>
            <option value="android">Android</option>
            <option value="firetablet">FireTablet</option>
            <option value="ios">iOS</option>
            <option value="tvos">tvOS</option>
            <option value="firetv">fireTV</option>
            <option value="androidtv">androidtv</option>
            <option value="roku">Roku</option>
            <option value="samsungtv">SamsungTV</option>
            <option value="lgtv">LGTV</option>
            <option value="xbox">XBox</option>
            <option value="foxteliq">Foxtel</option>
            <option value="playstation">playstation</option>
            <option value="chromecast">ChromeCast</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="profile" class="form-label">Profile</label>
          <select id="profile" class="form-select">
            <option value="adult">Adult</option>
            <option value="kids">Kids</option>
            <option value="childcontent">Child asset on Adult profile</option>
          </select>
        </div>
      </div>

      <div class="row g-3 mt-2">
        <div class="col-md-4">
          <label for="deviceAdTracking" class="form-label"
            >Device Ad Tracking</label
          >
          <select id="deviceAdTrackingSetting" class="form-select">
            <option value="enabled">Enabled</option>
            <option value="disabled">Disabled</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="CMPAdTracking" class="form-label">CMP Ad Setting</label>
          <select id="CMPAdTrackingSetting" class="form-select">
            <option value="notApplicable">Not Applicable</option>
            <option value="enabled">Consented</option>
            <option value="disabled">Not Consented</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="appVersion" class="form-label">Enter App Version</label>
          <input
            type="text"
            id="appVersion"
            class="form-control"
            placeholder="5.9, 5.10, etc"
          />
        </div>
      </div>

      <div class="row g-3 mt-2">
        <div class="col-md-8">
          <label for="url" class="form-label">Enter Ad Request URL</label>
          <input
            type="text"
            id="url"
            class="form-control"
            placeholder="Enter URL here"
          />
        </div>
        <div class="col-md-4 d-flex align-items-end">
          <button class="btn btn-primary w-100" onclick="add()">Submit</button>
        </div>
      </div>

      <div class="table-responsive mt-4">
        <table class="table table-bordered">
          <thead class="table-dark">
            <tr>
              <td
                style="
                  margin-right: 10px;
                  padding: 15px;
                  text-align: left;
                  width: 150px;
                "
              >
                <h6
                  style="
                    margin: 0;
                    padding: 0;
                    text-align: left;
                    font-weight: bold;
                  "
                >
                  AdrequestURL:
                </h6>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="margin-right: 10px; padding: 5px; text-align: left">
                <p id="myText" style="margin: 0; padding: 0; font-size: 16px">
                  <i>AdrequestURL will appear here</i>
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="table-responsive">
        <table class="table table-bordered table-striped">
          <colgroup>
            <col style="width: 50px" />
            <!-- S.No -->
            <col style="width: 200px" />
            <!-- Parameter -->
            <col style="width: 150px" />
            <!-- Actual Value -->
            <col style="width: 250px" />
            <!-- Expected Value -->
            <col style="width: 100px" />
            <!-- Status -->
          </colgroup>
          <thead class="table-dark">
            <tr>
              <th>S.No</th>
              <th>Parameter</th>
              <th>Actual Value</th>
              <th>Expected Value</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>

      <div class="table-responsive mt-4">
        <table class="table table-bordered table-striped" id="table2">
          <colgroup>
            <col style="width: 50px" />
            <!-- S.No -->
            <col style="width: 200px" />
            <!-- Parameter -->
            <col style="width: 150px" />
            <!-- Actual Value -->
            <col style="width: 250px" />
            <!-- Expected Value -->
            <col style="width: 100px" />
            <!-- Status -->
          </colgroup>
          <thead class="table-dark">
            <tr>
              <th colspan="5" class="text-center">
                Additional Ad Request Parameter Validation
              </th>
            </tr>
            <tr>
              <th>S.No</th>
              <th>Parameter</th>
              <th>Actual Value</th>
              <th>Expected Value</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="tableBody2"></tbody>
        </table>
      </div>

      <p class="footer">Developed by GQA - AdTech</p>
    </div>

    <style>
      body {
        background-color: #f8f9fa;
        font-family: Arial, sans-serif;
      }
      .container {
        background: white;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin-top: 10px;
      }
      .title {
        color: #3883fa;
        text-align: center;
        margin-bottom: 20px;
      }
      .form-select,
      .form-control {
        border-radius: 8px;
      }
      .btn {
        border-radius: 8px;
        transition: 0.3s;
      }
      .btn:hover {
        opacity: 0.8;
      }
      .table {
        margin-top: 20px;
        border-radius: 8px;
        overflow: hidden;
      }
      .table th,
      .table td {
        text-align: left;
        vertical-align: text-top;
      }
      .table th:nth-child(3),
      .table td:nth-child(3) {
        /* Restrict "Actual Value" column width */
        width: 250px;
        max-width: 250px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .footer {
        text-align: right;
        margin-top: 20px;
        font-size: 14px;
      }
    </style>
    <script>
      const getData = (
        device,
        profileName,
        adrequestParam,
        deviceAdTracking,
        region
      ) => {
        let jsonData = {
          commonParams: {
            deviceAdtrackingEnabled: {
              adult: { _fw_is_lat: "0" },
              kids: { _fw_is_lat: "1", _fw_did: null, paln: null },
            },
            deviceAdtrackingDisabled: {
              adult: { _fw_is_lat: "1", _fw_did: null, paln: null },
              kids: { _fw_is_lat: "1", _fw_did: null, paln: null },
            },
            flag: " fbad scpv emcr sltp qtcb slcb aeti vicb dtrd",
            resp: "vmap1 vast4",
            mode: "on-demand",
          },

          commonRegions: {
            AUS: {
              nw: "386345",
              afid: "431029310",
              hostvalue: "https://5e529.v.fwmrm.net",
              _fw_gdpr_consent: "0",
              product: "beam",
              _fw_gdpr: "0",
              platform: device,
            },
          },

          commonProfiles: {
            adult: {
              _fw_coppa: "0",
              restrictedProfile: "0",
            },
            kids: {
              _fw_coppa: "1",
              restrictedProfile: "1",
            },
            childcontent: {
              _fw_coppa: "1",
              restrictedProfile: "1",
            },
          },

          devices: {
            chrome: {
              platform: "web",
              metr: "135",
              playername: "BeamPlayerDesktop/5.10.0",
              prof: "386345:dni_max_apac_web_vod_prod",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/web/desktop",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/web/desktop/kids",
                },
              },
            },

            android: {
              playername: "DiscoveryPlayerAndroidgooglePlay/5.10.0",
              prof: "386345:dni_max_apac_android_vod_prod",
              _fw_us_privacy: "1---",
              metr: "135",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/app/android/phone",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/app/android/phone/kids",
                },
              },
            },

            ios: {
              playername: "DiscoveryPlayeriosnative/1.0",
              prof: "386345:dni_max_apac_ios_vod_prod",
              _fw_us_privacy: "1---",
              metr: "135",
              _fw_atts: "1",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/app/ios/phone",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/app/ios/phone/kids",
                },
              },
            },

            tvos: {
              playername: "DiscoveryPlayertvOSnative/1.0",
              prof: "386345:dni_max_apac_tvos_vod_prod",
              metr: "1159",
              _fw_atts: "1",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/tvos",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/tvos/kids",
                },
              },
            },

            firetv: {
              playername: "DiscoveryPlayerAndroidfireTV/1.9.1-alpha.950",
              metr: "1159",
              prof: "386345:dni_max_apac_firetv_vod_prod",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/firetv",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/firetv/kids",
                },
              },
            },

            roku: {
              playername: "RokuPSDK/0.1.0",
              metr: "1159",
              prof: "386345:dni_max_apac_roku_vod_prod",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/roku",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/roku/kids",
                },
              },
            },

            samsungtv: {
              playername: "BeamPlayerTV/5.10.0",
              metr: "1159",
              prof: "386345:dni_max_apac_samsungtv_vod_prod",
              wta: "0",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/samsungtv",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/samsungtv/kids",
                },
              },
            },
            chromecast: {
              metr: "1159",
              prof: "386345:dni_max_apac_chromecast_vod_prod",
              playername: "MaxPlayerChromecast/5.9.0",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/chromecast",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/chromecast/kids",
                },
              },
            },

            foxteliq: {
              metr: "1159",
              prof: "386345:dni_max_apac_foxteliq_vod_prod",
              playername: "BeamPlayerSTB/5.10.0",
              wta: "0",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/foxteliq",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/foxteliq/kids",
                },
              },
            },

            safari: {
              platform: "web",
              metr: "135",
              prof: "386345:dni_max_apac_web_vod_prod",
              playername: "BeamPlayerDesktop/5.10.0",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/web/desktop",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/web/desktop/kids",
                },
              },
            },

            firetablet: {
              metr: "135",
              prof: "386345:dni_max_apac_firetablet_vod_prod",
              playername: "DiscoveryPlayerAndroidkindle/5.10.0",
              wta: "1",
              adult: {
                AUS: {
                  csid: "apac/max/AU/app/firetablet",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/app/firetablet/kids",
                },
              },
            },
            lgtv: {
              metr: "1159",
              prof: "386345:dni_max_apac_lgtv_vod_prod",
              playername: "BeamPlayerTV/5.10.0",
              wta: "0",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/lgtv",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/lgtv/kids",
                },
              },
            },
            xbox: {
              metr: "1159",
              prof: "386345:dni_max_apac_xbox_vod_prod",
              playername: "BeamPlayerConsole/5.10.0",
              wta: "0",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/xbox",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/xbox/kids",
                },
              },
            },
            playstation: {
              metr: "1159",
              prof: "386345:dni_max_apac_playstation_vod_prod",
              wta: "0",
              playername: "BeamPlayerConsole/5.10.0",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/playstation",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/playstation/kids",
                },
              },
            },
            androidtv: {
              metr: "1159",
              prof: "386345:dni_max_apac_androidtv_vod_prod",
              wta: "1",
              playername: "",
              adult: {
                AUS: {
                  csid: "apac/max/AU/ctv/androidtv",
                },
              },
              kids: {
                AUS: {
                  csid: "apac/max/AU/ctv/androidtv/kids",
                },
              },
            },
          },
        };

        let expectedData;
        switch (adrequestParam) {
          case "_fw_is_lat":
          case "paln":
            if (deviceAdTracking === "enabled") {
              expectedData =
                jsonData.commonParams.deviceAdtrackingEnabled[profileName][
                  adrequestParam
                ];
            } else if (deviceAdTracking === "disabled") {
              expectedData =
                jsonData.commonParams.deviceAdtrackingDisabled[profileName][
                  adrequestParam
                ];
            }
            break;

          case "_fw_coppa":
          case "restrictedProfile":
            expectedData = jsonData.commonProfiles[profileName][adrequestParam];
            break;

          case "csid":
          case "prof":
          case "playername":
          case "wta":

            if (document.getElementById("profile").value === "childcontent" && adrequestParam === "csid"){
              //profileName="adult";
              expectedData = jsonData.devices[device]["adult"][region][adrequestParam];
            } else{
            expectedData =
              jsonData.devices[device][profileName]?.[region]?.[
                adrequestParam
              ] ||
              jsonData.devices[device][profileName]?.[adrequestParam] ||
              jsonData.devices[device][adrequestParam];
              }
            break;

          case "flag":
          case "resp":
          case "mode":
            expectedData = jsonData.commonParams[adrequestParam];
            break;

          case "nw":
          case "afid":
          case "hostvalue":
          case "_fw_gdpr_consent":
          case "product":
          case "_fw_gdpr":
            expectedData = jsonData.commonRegions[region][adrequestParam];
            break;

          case "platform":
            if (device === "chrome" || device === "safari") {
              expectedData = jsonData.devices[device][adrequestParam];
              break;
            } else {
              expectedData = jsonData.commonRegions[region][adrequestParam];
              break;
            }

          default:
            expectedData = jsonData.devices[device][adrequestParam] || null;
        }

        return expectedData;
      };

      const validateFwDidValue = (
        actualParam,
        actualParamValue,
        expectedParamValue,
        count,
        table1,
        rowrow,
        fwDidStatus,
        deviceAdTracking,
        profileName,
        device
      ) => {
        for (i = 0; i < 1; i++) {
          var cell1 = document.createElement("td");
          var text1 = document.createTextNode(count);

          cell1.appendChild(text1);
          rowrow.appendChild(cell1);

          var cell2 = document.createElement("td");
          var text2 = document.createTextNode(actualParam);

          cell2.appendChild(text2);
          rowrow.appendChild(cell2);

          var cell3 = document.createElement("td");
          var text3 = "";

          

          var cell4 = document.createElement("td");
          var text4 = "";

          var cell5 = document.createElement("td");
          var text5 = "";
          var bgColor = ""
          if (fwDidStatus) {
            if (deviceAdTracking === "disabled") {
              text3 = "param is not present in the url";
              text4 = "Empty/Null";
              text5 = "PASS"
              bgColor = "#6ae66a";
            } 
            if(profileName === 'kids'){
              text3 = "param is not present in the url";
              text4 = "Empty/Null";
              text5 = "PASS"
              bgColor = "#6ae66a";
            } else if(['chrome','safari','chromecast','playstation','tvos','ios'].includes(device)){
                text3 = "param is not present in the url";
                text4 = "Empty/Null";
                text5 = "PASS"
                bgColor = "#6ae66a";
            } else{
                text3 = "param is not present in the url";
                text4 = "Expected String/Numeric Value";
                text5 = "FAIL"
                bgColor = "red";
            }
          } 
            else {
              if (deviceAdTracking === "disabled") {
              text3 = actualParamValue;
                text4 = "Expected Empty Value";
                text5 = "FAIL"
                bgColor = "red";
            } 
            if(profileName === 'kids'){
              text3 = actualParamValue;
                text4 = "Expected Empty Value";
                text5 = "FAIL"
                bgColor = "red";
            } else if(['chrome','safari','chromecast','playstation','tvos','ios'].includes(device)){
                text3 = actualParamValue;
                text4 = "Expected Empty Value";
                text5 = "FAIL"
                bgColor = "red";
            } else if (actualParamValue) {
                text3 = actualParamValue;
                text4 = "Expected String/Numeric Value";
                text5 = "PASS"
                bgColor = "#6ae66a";
              } else {
                text3 = actualParamValue;
                text4 = "Expected String/Numeric Value";
                text5 = "FAIL"
                bgColor = "red";
              }
            }
            cell3.appendChild(document.createTextNode(text3));
            rowrow.appendChild(cell3);

            cell4.appendChild(document.createTextNode(text4));
            rowrow.appendChild(cell4);

            cell5.appendChild(document.createTextNode(text5));
            cell5.style.backgroundColor = bgColor;
            rowrow.appendChild(cell5);
          
        }
        table1.appendChild(rowrow);
      };

      const validatePalnValue = (
        actualParam,
        actualParamValue,
        expectedParamValue,
        count,
        table1,
        rowrow,
        fwDidStatus,
        deviceAdTracking,
        profileName,
        device
      ) => {
        for (i = 0; i < 1; i++) {
          var cell1 = document.createElement("td");
          var text1 = document.createTextNode(count);

          cell1.appendChild(text1);
          rowrow.appendChild(cell1);

          var cell2 = document.createElement("td");
          var text2 = document.createTextNode(actualParam);

          cell2.appendChild(text2);
          rowrow.appendChild(cell2);

          var cell3 = document.createElement("td");
          var text3 = "";

          

          var cell4 = document.createElement("td");
          var text4 = "";

          var cell5 = document.createElement("td");
          var text5 = "";
          var bgColor = ""
          if (fwDidStatus) {
            if (deviceAdTracking === "disabled") {
              text3 = "param is not present in the url";
              text4 = "Empty/Null";
              text5 = "PASS"
              bgColor = "#6ae66a";
            } 
            if(profileName === 'kids'){
              text3 = "param is not present in the url";
              text4 = "Empty/Null";
              text5 = "PASS"
              bgColor = "#6ae66a";
            }  else{
                text3 = "param is not present in the url";
                text4 = "Expected String/Numeric Value";
                text5 = "FAIL"
                bgColor = "red";
            }
          } 
            else {
              if (deviceAdTracking === "disabled") {
              text3 = actualParamValue;
                text4 = "Expected Empty Value";
                text5 = "FAIL"
                bgColor = "red";
            } 
            if(profileName === 'kids'){
              text3 = actualParamValue;
                text4 = "Expected Empty Value";
                text5 = "FAIL"
                bgColor = "red";
            } else if (actualParamValue) {
                text3 = actualParamValue;
                text4 = "Expected String/Numeric Value";
                text5 = "PASS"
                bgColor = "#6ae66a";
              } else {
                text3 = actualParamValue;
                text4 = "Expected String/Numeric Value";
                text5 = "FAIL"
                bgColor = "red";
              }
            }
            cell3.appendChild(document.createTextNode(text3));
            rowrow.appendChild(cell3);

            cell4.appendChild(document.createTextNode(text4));
            rowrow.appendChild(cell4);

            cell5.appendChild(document.createTextNode(text5));
            cell5.style.backgroundColor = bgColor;
            rowrow.appendChild(cell5);
          
        }
        table1.appendChild(rowrow);
      };


      const validateParam = (
        actualParam,
        actualParamValue,
        expectedParamValue,
        count,
        table1,
        rowrow
      ) => {
        for (i = 0; i < 1; i++) {
          var cell1 = document.createElement("td");
          var text1 = document.createTextNode(count);

          cell1.appendChild(text1);
          rowrow.appendChild(cell1);

          var cell2 = document.createElement("td");
          var text2 = document.createTextNode(actualParam);

          cell2.appendChild(text2);
          rowrow.appendChild(cell2);

          var cell3 = document.createElement("td");
          var text3 = document.createTextNode(actualParamValue);

          cell3.appendChild(text3);
          rowrow.appendChild(cell3);

          if (actualParam.includes("not present in the url")) {
            cell3.style.backgroundColor = "red";
          }

          var cell4 = document.createElement("td");
          var text4 = document.createTextNode(expectedParamValue);

          cell4.appendChild(text4);
          rowrow.appendChild(cell4);

          var cell5 = document.createElement("td");
          var text5 = "";

           if (actualParamValue == expectedParamValue) {
            text5 = document.createTextNode("PASS");
            cell5.appendChild(text5);
            rowrow.appendChild(cell5);
            cell5.style.backgroundColor = "#6ae66a";
          } else {
            text5 = document.createTextNode("FAIL");
            cell5.appendChild(text5);
            rowrow.appendChild(cell5);
            cell5.style.backgroundColor = "red";
          }
        }
        table1.appendChild(rowrow);
      };

      //===================================================================================================================

      const validateAdditionParam = (
        actualParam,
        actualParamValue,
        count,
        table1,
        rowrow
      ) => {
        for (i = 0; i < 1; i++) {
          var cell1 = document.createElement("td");
          var text1 = document.createTextNode(count);

          cell1.appendChild(text1);
          rowrow.appendChild(cell1);

          var cell2 = document.createElement("td");
          var text2 = document.createTextNode(actualParam);

          cell2.appendChild(text2);
          rowrow.appendChild(cell2);

          var cell3 = document.createElement("td");
          var text3 = document.createTextNode(actualParamValue);

          cell3.appendChild(text3);
          rowrow.appendChild(cell3);

          if (actualParam.includes("not present in the url")) {
            cell3.style.backgroundColor = "red";
          }

          var cell4 = document.createElement("td");
          var text4 = document.createTextNode("Expected String/Numeric Value");

          cell4.appendChild(text4);
          rowrow.appendChild(cell4);

          var cell5 = document.createElement("td");
          var text5 = "";

          if (actualParamValue) {
            text5 = document.createTextNode("PASS");
            cell5.appendChild(text5);
            rowrow.appendChild(cell5);
            cell5.style.backgroundColor = "#6ae66a";
          } else {
            text5 = document.createTextNode("FAIL");
            cell5.appendChild(text5);
            rowrow.appendChild(cell5);
            cell5.style.backgroundColor = "red";
          }
        }
        table1.appendChild(rowrow);
      };

      async function add() {
        document.getElementById("tableBody").innerHTML = "";
        document.getElementById("tableBody2").innerHTML = "";
        let adUrl = document.getElementById("url").value;
        let profileName = document.getElementById("profile").value;
        let device = document.getElementById("device").value.trim();
        let deviceAdTracking = document.getElementById(
          "deviceAdTrackingSetting"
        ).value;
        let region = document.getElementById("Country").value;
        let appVersion = document.getElementById("appVersion").value;

        if (profileName === "childcontent"){
          profileName = "kids";
        }

        document.getElementById("myText").innerHTML = adUrl;

        adUrl = adUrl.replace(/;ptgt/g, "&ptgt");

        var url = new URL(adUrl);
        let search = new URLSearchParams(url.search);

        const commonParams = [
          "nw",
          "csid",
          "caid",
          "hostvalue",
          "afid",
          "pvrn",
          "vprn",
          "flag",
          "metr",
          "prof",
          "resp",
          "vdur",
          "vip",
          "mode",
          ";_fw_vcid2",
          "accountid",
          "_fw_h_user_agent",
          "_fw_h_referer",
          "_fw_coppa",
          "restrictedProfile",
          "_fw_gdpr",
          "preroll",
          "product",
          "platform",
          "program_id",
          "playbackId",
          "playername",
          "_fw_nielsen_app_id",
          "ptgt",
          "tpcl",
          "cpsq",
          "tpos",
          "_fw_gdpr_consent",
          "_fw_content_language",
          "wta",
        ];

        const commonValidationParams = [
          "nw",
          "csid",
          "hostvalue",
          "afid",
          "flag",
          "metr",
          "prof",
          "resp",
          "mode",
          "_fw_coppa",
          "restrictedProfile",
          "_fw_gdpr",
          "_fw_is_lat",
          "_fw_atts",
          "platform",
          "playername",
          "_fw_gdpr_consent",
          "product",
          "wta",
        ];

        const deviceSpecificParams = {
          chrome: ["_fw_cookie_consent", "paln", "_fw_is_lat","_fw_did"],
          safari: ["_fw_cookie_consent", "paln", "_fw_is_lat"],
          android: ["paln", "_fw_is_lat", "_fw_did"],
          androidtv: ["paln", "_fw_is_lat", "_fw_did"],
          firetablet: ["paln", "_fw_is_lat", "_fw_did"],
          ios: ["_fw_atts","_fw_did"],
          tvos: ["_fw_atts","_fw_did"],
          firetv: ["paln", "_fw_is_lat", "_fw_did"],
          roku: ["paln", "_fw_is_lat", "_fw_did"],
          lgtv: ["_fw_is_lat", "_fw_did"],
          samsungtv: ["_fw_is_lat", "_fw_did"],
          foxteliq: ["_fw_is_lat", "_fw_did"],
          chromecast: ["paln", "_fw_is_lat", "_fw_did"],
          playstation: ["_fw_is_lat", "_fw_did"],
          xbox: ["_fw_is_lat", "_fw_did"],
        };

        const deviceSpecificValidationParams = {
          chrome: [],
          android: [],
          ios: ["_fw_atts"],
          tvos: ["_fw_atts"],
          firetv: [],
          roku: [],
        };

        let paramArr = [
          ...commonParams,
          ...(deviceSpecificParams[device.toLowerCase()] || []),
        ];
        let paramForValidation = [
          ...commonValidationParams,
          ...(deviceSpecificValidationParams[device.toLowerCase()] || []),
        ];

        // if (profileName !== "adult") {
        //   paramArr = paramArr.filter((p) => p !== "paln" && p !== "_fw_did");
        //   paramForValidation = paramForValidation.filter(
        //     (p) => p !== "paln" && p !== "_fw_did"
        //   );
        // }

        // if (deviceAdTracking === "disabled") {
        //   paramArr = paramArr.filter((p) => p !== "paln" && p !== "_fw_did");
        //   paramForValidation = paramForValidation.filter(
        //     (p) => p !== "paln" && p !== "_fw_did"
        //   );
        // }

        let count1 = 1;
        let count2 = 1;

        let fwDidStatus = false;
        for (var i = 0; i < paramArr.length; i++) {
          var adRequestParam = paramArr[i];
          var actualParamValue = "";
          let expectedParam;
          if (search.has(paramArr[i])) {
            if (adRequestParam === "vprn") {
              let data = search.get(adRequestParam);
              actualParamValue = data.split(";")[0];
            } else if (adRequestParam === "flag") {
              let data = search.get(adRequestParam);
              actualParamValue = data.split(";")[0];
            } else {
              actualParamValue = search.get(adRequestParam);
            }
          } else {
            if (adRequestParam === "hostvalue") {
              const { protocol, hostname } = url;
              actualParamValue = `${protocol}//${hostname}`;
            } else if(adRequestParam ===  "_fw_did" || adRequestParam ===  "paln" ){
                fwDidStatus = true;
            } else {
              adRequestParam =
                "Parameter " + adRequestParam + " is not present in the url";
            }
          }

          if (paramForValidation.includes(adRequestParam)) {
            var table1 = document.getElementById("tableBody");
            var rowrow = document.createElement("tr");
            expectedParam = getData(
              device,
              profileName,
              adRequestParam,
              deviceAdTracking,
              region
            );
              validateParam(
              adRequestParam,
              actualParamValue,
              expectedParam,
              count1,
              table1,
              rowrow
            );
            count1++;
          } else {
            var table1 = document.getElementById("tableBody2");
            var rowrow = document.createElement("tr");

            if(adRequestParam === '_fw_did'){
              validateFwDidValue(
                adRequestParam,
                actualParamValue,
                expectedParam,
                count2,
                table1,
                rowrow,
                fwDidStatus,
                deviceAdTracking,
                profileName,
                device
              )
            } else if(adRequestParam === 'paln'){
              validatePalnValue(
                adRequestParam,
                actualParamValue,
                expectedParam,
                count2,
                table1,
                rowrow,
                fwDidStatus,
                deviceAdTracking,
                profileName,
                device
              )
            } else { 
                validateAdditionParam(
                adRequestParam,
                actualParamValue,
                count2,
                table1,
                rowrow
              );
            }
            count2++;
          }
        }
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
<!DOCTYPE html>

